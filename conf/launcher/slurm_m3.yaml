# @package _global_ 

defaults: 
  - override /hydra/launcher: submitit_slurm

hydra:
  launcher: 
    timeout_min: 240
    cpus_per_task: 4
    tasks_per_node: ${gpus}
    mem_gb: 128
    nodes: 1
    name: ${hydra.job.name}
    stderr_to_stdout: True
    qos: m3
    gres: "gpu:${gpus}"
    signal_delay_s: 120
    max_num_timeout: 100
    array_parallelism: 256
    setup: 
      - "export MASTER_PORT=29500"
      - "export MASTER_ADDR=localhost"
      - "export TQDM_DISABLE=True"

gpus: 8
output_dir: /checkpoint/${oc.env:USER}/${oc.env:SLURM_JOB_ID}
wandb:
  id: ${oc.env:SLURM_JOB_ID}